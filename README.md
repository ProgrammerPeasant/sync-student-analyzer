# Sync Student Analyzer

## Описание архитектуры

Проект реализует микросервисную архитектуру для анализа и хранения файлов студентов (текстовых файлов, txt (никаких проверок на каррапт или тип файла нет, иначе это крайне сильно раздувает проект)). Система состоит из следующих сервисов:

- **Eureka Server** - сервис обнаружения, регистрирует все микросервисы (там особо кода и не нужно)
- **API Gateway** - единая точка входа для всех запросов, маршрутизирует их к нужным микросервисам
- **File Storage Service** - отвечает за загрузку, хранение и выдачу текстовых файлов
- **File Analysis Service** - анализирует загруженные файлы и возвращает результаты анализа, анализ на плагиат и получение всех результатов анализа

Взаимодействие между сервисами осуществляется по REST API. Для балансировки нагрузки и отказоустойчивости используется Eureka. В случае недоступности одного из сервисов, API Gateway перенаправляетт запросы, корректно обрабатывает ошибку и возвращает информативный ответ клиенту.
Помимо этих сервисов, отдельно контейнеры PostregSQL для хранения данных analysis service && storage service.
Также наличие хеша у всех файлов и отсутствие копий в бд (на уровне клиента разницы нет), также файлы нулевого веса (без текста) не сохраняются.
## Схема архитектуры

Клиент -> API Gateway - Eureka Server -> (File Storage Service | File Analysis Service) -> База данных (PostgreSQL)
В целом почти идентично предложенному варианту на картинке 
Также глобальные обработчики ошибок у сервисов реализованы с чуть более подробными ответами

## Спецификация API (и примеры актуальных эндпоинтов)

Сгенерированная документация API доступна по адресу `http://localhost:8080/swagger-ui.html`
Примерно опишу вид методов, при этом, надо полагать, что curl выглядит иначе, так как gateway перенаправляет запросы на нужный сервис

### File Storage Service

- `POST api/files/upload` — загрузка файла и т. д., остальные метод можно увидеть в swagger

### File Analysis Service

- `POST api/analysis` — анализ файла (передаётся ID файла) (остальные также в сваггере)

### Plagiarism Service (входит в File Analysis Service)

- `POST /api/analysis/plagiarism/check` — анализ на плагиат (передаётся ID файла) (остальные также в сваггере)

## Запуск проекта

1. Склонируйте репозиторий:
   ```
   https://github.com/ProgrammerPeasant/sync-student-analyzer.git
   ```
2. Перейдите в корень проекта и выполните (всё должно собрать, так как в докер-файлах уже прописаны билды):
   ```
    docker-compose up --build
   ```
   После поднятия контейнеров, сваггер может не моментально заработать (порядка 30 секунд (иногда почему-то и минута бывает), статус healthy на сервисы не завез)))
3. Откройте браузер и перейдите по адресу `http://localhost:8080/swagger-ui.html` (Swagger UI).